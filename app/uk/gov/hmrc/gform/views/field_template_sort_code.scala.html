@import uk.gov.hmrc.gform.models.{FormFieldValidationResult, ValidationUtil}
@import uk.gov.hmrc.gform.sharedmodel.form._
@import uk.gov.hmrc.gform.sharedmodel.formtemplate._
@import uk.gov.hmrc.play.views.html.helpers._
@import uk.gov.hmrc.gform.service.LabelHelper

@import uk.gov.hmrc.gform.sharedmodel.formtemplate.UkSortCode
@import uk.gov.hmrc.gform.sharedmodel.formtemplate.FieldValue
@(fieldValue: FieldValue, sC: UkSortCode, prepop: String, validationResult: Option[FormFieldValidationResult], index: Int)

<div class="form-group">
    <div class="@if(validationResult.map(_.isOk).contains(false)) { form-field-group--error }">
        @* TODO: What should total style be? *@
      <label class="form-label-bold" for="@{fieldValue.id}">@localisation(LabelHelper.buildRepeatingLabel(fieldValue, index))</label>

      @if(fieldValue.helpText) {
      <div class="form-field--hint">@{fieldValue.helpText}</div>
      }

        @{
            val map: Map[String, Set[String]] = validationResult.map(x => ValidationUtil.renderErrors("", x)).getOrElse(Map.empty)
            val errors: Set[String] = ValidationUtil.printErrors(map)

            errors.map(e => errorInline(e, e, Seq("")))
        }

        <input
                type="text"
                name="@fieldValue.id.withSuffix("1")"
        @if(!fieldValue.editable) { readonly="" }
        id="@fieldValue.id.withSuffix("1")"
        value="@validationResult.flatMap(_.getOptionalCurrentValue(fieldValue.id.withSuffix("1").toString)).getOrElse("")"
        class="input--xxsmall push--left">
        -
        <input
                type="text"
                name="@fieldValue.id.withSuffix("2")"
        @if(!fieldValue.editable) { readonly="" }
        id="@fieldValue.id.withSuffix("2")"
        value="@validationResult.flatMap(_.getOptionalCurrentValue(fieldValue.id.withSuffix("2").toString)).getOrElse("")"
        class="input--xxsmall">
        -
        <input
                type="text"
                name="@fieldValue.id.withSuffix("3")"
        @if(!fieldValue.editable) { readonly="" }
        id="@fieldValue.id.withSuffix("3")"
        value="@validationResult.flatMap(_.getOptionalCurrentValue(fieldValue.id.withSuffix("3").toString)).getOrElse("")"
        class="input--xxsmall">

    </div>
</div>
